!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(b,c){return void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(b)),a(c),c}:a(jQuery)}(function(a){function b(b,c){var d=a.extend({},a.fn.textifyed.defaults,c);this.text=d.text,this.placeholder=d.placeholder,this.div=a(d.div),this.textarea=a(b),this.$el=a(b),this.btnDone=this.div.siblings(".btnDone"),this.btnCancel=this.div.siblings(".btnCancel"),this.trigger=d.trigger,this.Editor=d.Editor,this.init()}b.prototype={lessText:" Less...",moreText:" More...",constructor:b,_events:[],_attachEvents:function(){var b={};b[a(this.trigger).selector]=a.proxy(this.notesDivClick,this),this._events=[[this.div,b],[this.btnDone,{click:a.proxy(this.done,this)}],[this.btnCancel,{click:a.proxy(this.cancel,this)}]];for(var c,d,e=0;e<this._events.length;e++)c=this._events[e][0],d=this._events[e][1],c.on(d)},init:function(){this.Editor?(this.attachEditor(),this.showDivHideTextarea()):this.setNotes(),this._attachEvents()},setTextarea:function(){this.editorId=this.textarea?a(this.textarea).attr("id"):this.$el.attr("id"),this.textarea=tinymce.get(this.editorId),this.setNotes()},getTextareaVal:function(){return null!=this.editor?this.textarea.getContent():this.textarea.val()},setTextareaVal:function(){a.isFunction(this.textarea.setContent)?this.textarea.setContent(this.text):this.textarea.val(this.text)},attachEditor:function(){this.textarea.on("custom:init",a.proxy(this.setTextarea,this)),this.editor=new this.Editor(this.textarea)},setNotes:function(){""!==this.text&&null!=this.text?(this.div.html(a("<pre>").append(this.text)).removeClass("muted"),this.setTextareaVal()):this.div.show().addClass("muted").html(this.placeholder),this.showDivHideTextarea(),this.collapse()},showDivHideTextarea:function(){this.btnDone.hide(),this.btnCancel.hide(),this.div.show().css({height:"auto","padding-top":"5px"}),this.textarea.hide()},hideDivShowTextarea:function(){if(this.Editor&&this.textarea===this.$el){var a=null!=this.btnMore&&this.btnMore.text()===this.lessText;this.attachEditor(),a&&this.btnMore.text(this.moreText).click()}var b=this.div,c=b.height(),d=c>100?c:"100";b.hide(),this.textarea.show(),null==this.editor?this.textarea.height(d+"px").focus():(this.textarea.theme.resizeTo("100%",d),this.div.next(".mce-container").css({"max-width":"800px"}),this.textarea.focus()),this.btnDone.show(),this.btnCancel.show(),this.div.siblings(".moreLink").hide()},notesDivClick:function(){this.hideDivShowTextarea(),this.div.trigger("textifyed:notesDivClick")},done:function(b){var c=this.getTextareaVal(),d=a(b.currentTarget);d.trigger("textifyed:done",c),this.text=a.trim(c),this.showDivHideTextarea(),this.setNotes(),this.collapse()},cancel:function(b){this.setTextareaVal();var c=a(b.currentTarget);c.trigger("textifyed:cancel"),this.showDivHideTextarea(),this.setNotes(),this.collapse()},collapse:function(){var b=this.div,c=3*parseInt(b.css("line-height")),d=b.height();d>c&&(b.css({height:c+"px",overflow:"hidden"}),0==b.siblings(".moreLink").length?this.$el.after("<a href='#' class='moreLink'> More...</a>"):b.siblings(".moreLink").text(this.moreText).show()),this.btnMore=b.siblings(".moreLink").length>0?b.siblings(".moreLink"):null,null!=this.btnMore&&this.btnMore.off("click",this.moreLessToggle).on("click",a.proxy(this.moreLessToggle,this))},moreLessToggle:function(b){b.preventDefault();var c=a(b.currentTarget),d=this.div;c.text()===this.moreText?(c.text(this.lessText),d.css({overflow:"auto",height:"auto"}),this.expanded=!0):(c.text(this.moreText),this.collapse())}},a.fn.textifyed=function(c){var d=Array.apply(null,arguments);return d.shift(),this.each(function(){var e=a(this),f=e.data("textifyed"),g="object"==typeof c&&c;f||e.data("textifyed",f=new b(this,g)),"string"==typeof c&&"function"==typeof f[c]&&f[c].apply(f,d)})},a.fn.textifyed.defaults={trigger:"click",placeholder:"Click to add text..",text:"",div:null,Editor:null}});